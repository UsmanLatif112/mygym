{% extends "base.html" %}
{% block content %}
<h1 style="color:#ff7300; letter-spacing:1px; margin-bottom: 28px;">Employees</h1>
<div class="customers-header">
    <div></div>
    <button class="leet-btn" style="width:auto; padding:12px 26px; font-size:1em;" onclick="openAddEmployeeModal()">
        <i class="fa fa-user-plus"></i> Add Employee
    </button>
</div>
<div class="customers-table-wrap">
    <table class="customers-table">
        <thead>
            <tr>
                <th>Employee Name</th>
                <th>Employee Cnic</th>
                <th>Employment Type</th>
                <th>Shift</th>
                <th>Salary</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody class="customers-table-body">
            {% for e in employees %}
            <tr>
                <td>{{ e.name }}</td>
                <td>{{ e.cnic }}</td>
                <td>{{ e.employment_type }}</td>
                <td>{{ e.shift }}</td>
                <td>{{ e.salary or 'No data' }}</td>
                <td>
                    {% if e.status and e.status|lower == 'active' %}
                        <span class="status-badge status-active">{{ e.status }}</span>
                    {% elif e.status and e.status|lower == 'inactive' %}
                        <span class="status-badge status-inactive">{{ e.status }}</span>
                    {% else %}
                        <span class="status-badge status-unpaid">{{ e.status or 'Inactive' }}</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('manage_employee', employee_id=e.id) }}" class="manage-btn">Manage</a>
                </td>
            </tr>

            {% else %}
            <tr>
                <td colspan="5" style="text-align:center; padding:20px;">No employees found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
.toast-success {
    position: fixed;
    top: 36px;
    right: 36px;
    min-width: 260px;
    background: #36b37e;
    color: #fff;
    padding: 16px 30px;
    border-radius: 8px;
    font-size: 1.08em;
    box-shadow: 0 4px 24px #0002;
    z-index: 9999;
    opacity: 0.97;
    animation: toast-in 0.3s, toast-out 0.4s 2.4s forwards;
    font-weight: 600;
    letter-spacing: 0.2px;
}
@keyframes toast-in { from {opacity: 0; transform: translateY(-20px);} to {opacity: 0.97; transform: translateY(0);} }
@keyframes toast-out { from {opacity: 0.97;} to {opacity: 0;} }
</style>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        {% for category, message in messages %}
          var toast = document.createElement('div');
          toast.className = 'toast-success';
          toast.innerText = "{{ message|escape }}";
          document.body.appendChild(toast);
          setTimeout(function() { toast.remove(); }, 2800);
        {% endfor %}
      });
    </script>
  {% endif %}
{% endwith %}

<div id="addEmployeeModal" class="modal-overlay" style="display:none;">
  <div class="modal-content" style="max-width:500px;">
    <h2>Add Employee</h2>
    <form id="addEmployeeForm" method="POST" action="{{ url_for('add_employee') }}">
      {{ form.hidden_tag() }}
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="name">Employee Name:</label>
        {{ form.name(class_="form-input", id="name") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="cnic">Employee cnic:</label>
        {{ form.cnic(class_="form-input", id="cnic") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="employment_type">Employment Type:</label>
        {{ form.employment_type(class_="form-input", id="employment_type") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="timing">Timing:</label>
        {{ form.timing(class_="form-input", id="timing") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="shift">Shift:</label>
        {{ form.shift(class_="form-input", id="shift") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="salary">Salary:</label>
        {{ form.salary(class_="form-input", id="salary") }}
      </div>
      <div class="form-block" style="margin-bottom:15px;font-size:15px;">
        <label for="status">Status:</label>
        {{ form.status(class_="form-input", id="status") }}
      </div>
      <div class="form-block" style="display: flex; gap: 10px;">
        <button type="submit" class="leet-btn">Add Employee</button>
        <button type="button" class="leet-btn modal-close-btn" onclick="closeAddEmployeeModal()">Cancel</button>
    </div>

    </form>
  </div>
</div>


<script>
function openAddEmployeeModal() {
    document.getElementById('addEmployeeModal').style.display = 'flex';
}
function closeAddEmployeeModal() {
    document.getElementById('addEmployeeModal').style.display = 'none';
}
</script>

{% endblock %}
